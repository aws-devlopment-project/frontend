<div class="MenuWrapper">
    <!-- 메뉴바 - 항상 표시 -->
    <aside class="menuBar">
        <div class="menuBarIcon" 
             (click)="setActiveTab('home')"
             [class.active]="isActiveTab('home')"
             title="홈">
            <mat-icon>home</mat-icon>
            <p>홈</p>
        </div>
        <div class="menuBarIcon" 
             (click)="setActiveTab('group')"
             [class.active]="isActiveTab('group')"
             title="그룹">
            <mat-icon>group</mat-icon>
            <p>그룹</p>
        </div>
        <div class="menuBarIcon"
            (click)="setActiveTab('activity')"
            [class.active]="isActiveTab('activity')"
            title="Activity">
            <mat-icon>analytics</mat-icon>
            <p>통계</p>
        </div>
        <div class="menuBarIcon"
             (click)="setActiveTab('member')"
             [class.active]="isActiveTab('member')"
             title="회원관리">
            <mat-icon>admin_panel_settings</mat-icon>
            <p>관리</p>
        </div>
    </aside>
    
    <!-- 그룹바 - 그룹 탭에서만 표시되고, 토글 가능 -->
    <aside class="groupBar" 
           [class.collapsed]="!isGroupBarShown()"
           [style.display]="isGroupTabActive() ? 'flex' : 'none'">
        <div class="workspace-header">
            <h2 class="workspace-name">워크스페이스</h2>
            <div class="workspace-status">
                <span class="status-indicator"></span>
                온라인
            </div>
        </div>

        <!-- Dynamic Group Containers -->
        @if (userJoin?.joinList) {
            @for (group of userJoin?.joinList; track group.groupname) {
                <div class="toggleBarContainer">
                    <div class="toggleBar" 
                         (click)="toggleSection(group.groupname)"
                         [class.expanded]="isSectionExpanded(group.groupname)"
                         [class.active]="isActiveGroup(group.groupname)">
                        <mat-icon>keyboard_arrow_right</mat-icon>
                        <p>{{ group.groupname }}</p>
                    </div>
                    @if (isSectionExpanded(group.groupname)) {
                        <div class="channel-list">
                            @for (channel of group.clubList; track channel) {
                                <div class="clubBar" 
                                     [class.active]="isActiveChannel(channel)"
                                     (click)="selectChannel(channel)">
                                    {{ channel }}
                                    <!-- 읽지 않은 메시지 수가 있다면 표시 (선택사항) -->
                                    <!-- <span class="unread-indicator">3</span> -->
                                </div>
                            }
                        </div>
                    }
                </div>
            }
        }

        <!-- 데이터가 로딩 중이거나 없을 때 표시할 내용 -->
        @if (!userJoin) {
            <div class="toggleBarContainer">
                <div class="toggleBar">
                    <mat-icon>hourglass_empty</mat-icon>
                    <p>로딩 중...</p>
                </div>
            </div>
        }

        <!-- 가입한 그룹이 없을 때 -->
        @if (userJoin?.joinList && userJoin?.joinList?.length === 0) {
            <div class="toggleBarContainer">
                <div class="toggleBar">
                    <mat-icon>info</mat-icon>
                    <p>가입한 그룹이 없습니다</p>
                </div>
            </div>
        }

        <div class="sidebar-actions">
            <button class="action-button" (click)="browseChannels()">
                <mat-icon>explore</mat-icon>
                그룹 둘러보기
            </button>
        </div>
    </aside>
</div>