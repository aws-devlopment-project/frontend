<div class="join-container">
  <!-- í—¤ë” -->
  <div class="join-header">
    <h1>ê·¸ë£¹ì— ì°¸ì—¬í•´ë³´ì„¸ìš”! ğŸ¯</h1>
    <p>ê´€ì‹¬ ìˆëŠ” ê·¸ë£¹ì„ ì„ íƒí•˜ê³  ì›í•˜ëŠ” ì±„ë„ì— ì°¸ì—¬í•´ì„œ í™œë™ì„ ì‹œì‘í•´ë³´ì„¸ìš”</p>
  </div>

  <!-- ë‹¨ê³„ í‘œì‹œê¸° -->
  <div class="step-indicator">
    <div class="step" [class.active]="isStepActive(1)" [class.completed]="isStepCompleted(1)">
      <div class="step-number">1</div>
      <div class="step-text">ê·¸ë£¹ ì„ íƒ</div>
    </div>
    <div class="step" [class.active]="isStepActive(2)" [class.completed]="isStepCompleted(2)">
      <div class="step-number">2</div>
      <div class="step-text">ì±„ë„ ì„ íƒ</div>
    </div>
    <div class="step" [class.active]="isStepActive(3)" [class.completed]="isStepCompleted(3)">
      <div class="step-number">3</div>
      <div class="step-text">ì°¸ì—¬ ì™„ë£Œ</div>
    </div>
  </div>

  <!-- 1ë‹¨ê³„: ê·¸ë£¹ ì„ íƒ -->
  @if (isStep(1)) {
    <div class="step-content">
      <h2>ê´€ì‹¬ ìˆëŠ” ê·¸ë£¹ì„ ì„ íƒí•˜ì„¸ìš”</h2>
      
      <div class="groups-grid">
        @for (group of availableGroups(); track group.name) {
          <div class="group-card" 
               [class.selected]="selectedGroup()?.name === group.name"
               (click)="selectGroup(group)">
            
            <div class="group-header">
              <div class="group-emoji">{{ group.emoji }}</div>
              <div class="group-info">
                <h3>{{ group.name }}</h3>
                <div class="group-stats">
                  <span>ğŸ‘¥ {{ group.memberCount }}ëª…</span>
                  <span>ğŸ”¥ ì˜¤ëŠ˜ {{ group.activeToday }}ëª… í™œë™</span>
                </div>
              </div>
            </div>
            
            <p class="group-description">{{ group.description }}</p>
            
            <div class="group-tags">
              @for (tag of group.tags; track tag) {
                <span class="tag">#{{ tag }}</span>
              }
            </div>
            
            <div class="group-metrics">
              <span class="metric">ğŸ“ˆ ë‹¬ì„±ë¥  {{ group.achievementRate }}%</span>
              <span class="metric">â­ í‰ì  {{ group.rating }}</span>
            </div>
          </div>
        }
      </div>

      <div class="action-buttons">
        <button class="btn btn-primary" 
                [disabled]="!selectedGroup()"
                (click)="goToChannelSelection()">
          <mat-icon>arrow_forward</mat-icon>
          ë‹¤ìŒ: ì±„ë„ ì„ íƒí•˜ê¸°
        </button>
      </div>
    </div>
  }

  <!-- 2ë‹¨ê³„: ì±„ë„ ì„ íƒ -->
  @if (isStep(2)) {
    <div class="step-content">
      @if (selectedGroup(); as group) {
        <div class="selected-group-info">
          <div class="selected-group-header">
            <span class="selected-group-emoji">{{ group.emoji }}</span>
            <div>
              <h3>{{ group.name }}</h3>
              <p>{{ group.description }}</p>
            </div>
          </div>
        </div>
      }

      <h2>ì°¸ì—¬í•  ì±„ë„ì„ ì„ íƒí•˜ì„¸ìš”</h2>
      <p class="step-subtitle">ì—¬ëŸ¬ ì±„ë„ì„ ì„ íƒí•  ìˆ˜ ìˆìŠµë‹ˆë‹¤</p>

      <div class="channels-grid">
        @for (channel of availableChannels(); track channel.id) {
          <div class="channel-card"
               [class.selected]="isChannelSelected(channel.id)"
               (click)="toggleChannel(channel.id)">
            
            <div class="channel-header">
              <div class="channel-icon">{{ channel.icon }}</div>
              <div class="channel-info">
                <h4>{{ channel.name }}</h4>
                <div class="channel-activity">{{ channel.activity }}</div>
              </div>
            </div>
            
            <p class="channel-description">{{ channel.description }}</p>
            
            <div class="channel-members">
              ğŸ‘¥ {{ channel.members }}ëª… ì°¸ì—¬ ì¤‘
            </div>
          </div>
        }
      </div>

      <div class="action-buttons">
        <button class="btn btn-secondary" (click)="goBackToGroups()">
          <mat-icon>arrow_back</mat-icon>
          ê·¸ë£¹ ë‹¤ì‹œ ì„ íƒ
        </button>
        <button class="btn btn-primary" 
                [disabled]="!hasSelectedChannels() || isLoading()"
                (click)="joinSelectedGroup()">
          @if (isLoading()) {
            <div class="btn-spinner"></div>
            ì°¸ì—¬ ì¤‘...
          } @else {
            <mat-icon>check</mat-icon>
            ê·¸ë£¹ ì°¸ì—¬í•˜ê¸°
          }
        </button>
      </div>
    </div>
  }

  <!-- 3ë‹¨ê³„: ì™„ë£Œ -->
  @if (isStep(3)) {
    <div class="step-content completion-step">
      <div class="completion-icon">ğŸ‰</div>
      <h2>ì°¸ì—¬ ì™„ë£Œ!</h2>
      
      @if (selectedGroup(); as group) {
        <p class="completion-message">
          <strong>{{ group.name }}</strong>ì— ì„±ê³µì ìœ¼ë¡œ ì°¸ì—¬í–ˆìŠµë‹ˆë‹¤.<br>
          ì´ì œ ì„ íƒí•œ ì±„ë„ì—ì„œ í™œë™ì„ ì‹œì‘í•´ë³´ì„¸ìš”!
        </p>
        
        <div class="selected-channels-summary">
          <h4>ì°¸ì—¬í•œ ì±„ë„</h4>
          <div class="channel-tags">
            @for (channelName of getSelectedChannelNames(); track channelName) {
              <span class="channel-tag">{{ channelName }}</span>
            }
          </div>
        </div>
      }

      <div class="action-buttons">
        <button class="btn btn-primary btn-large" (click)="goToDashboard()">
          <mat-icon>dashboard</mat-icon>
          ëŒ€ì‹œë³´ë“œë¡œ ì´ë™
        </button>
      </div>
    </div>
  }
</div>